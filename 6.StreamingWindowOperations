//6.Streaming Window Operations on DStreams

package com.SimpleSparkDemo
import org.apache.spark.SparkContext
import org.apache.spark.SparkContext._
import org.apache.spark.SparkConf
import org.apache.spark.streaming._
import org.apache.spark.storage.StorageLevel

object WindowSparkStreaming extends App {
  
  
  val conf = new SparkConf().setAppName("Stateful Word Count").setMaster("local[2]")
  val ssc = new StreamingContext(conf,Seconds(10))  // Seconds(1) - batch size of 10 
    
  val lines = ssc.socketTextStream("localhost", 40412) 

  val words = lines.flatMap (_.split(" ")  )
  val pairs = words.map( word => (word,1) )
  val wordCounts =pairs.reduceByKeyAndWindow((x:Int,y:Int)=>(x+y) ,Seconds(30), Seconds(10))
  wordCounts.print()
  
  ssc.start()
  ssc.awaitTermination()


}

